# auto-trader-infra

This package was automatically generated by the [Terraform in Depth Cookiecutter Template](https://github.com/TerraformInDepth/terraform-module-cookiecutter). You should replace this description with some information about your project.

## API

<!-- BEGIN_TF_DOCS -->
## Requirements

| Name | Version |
|------|---------|
| <a name="requirement_terraform"></a> [terraform](#requirement\_terraform) | ~> 1.10 |
| <a name="requirement_terraform"></a> [terraform](#requirement\_terraform) | >= 1.5 |
| <a name="requirement_aws"></a> [aws](#requirement\_aws) | ~> 5.0 |
| <a name="requirement_aws"></a> [aws](#requirement\_aws) | >= 5.0 |

## Providers

| Name | Version |
|------|---------|
| <a name="provider_aws"></a> [aws](#provider\_aws) | ~> 5.0 >= 5.0 |

## Modules

| Name | Source | Version |
|------|--------|---------|
| <a name="module_lambda_builds_bucket"></a> [lambda\_builds\_bucket](#module\_lambda\_builds\_bucket) | trussworks/s3-private-bucket/aws | ~> 7.0 |
| <a name="module_signal_bot_lambda"></a> [signal\_bot\_lambda](#module\_signal\_bot\_lambda) | trussworks/lambda/aws | n/a |

## Resources

| Name | Type |
|------|------|
| [aws_cloudwatch_event_rule.position_check](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudwatch_event_rule) | resource |
| [aws_cloudwatch_event_target.position_check](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudwatch_event_target) | resource |
| [aws_dynamodb_table.trade_log](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/dynamodb_table) | resource |
| [aws_iam_policy.signal_bot](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_policy) | resource |
| [aws_lambda_function_url.signal_bot](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lambda_function_url) | resource |
| [aws_lambda_permission.cron](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lambda_permission) | resource |
| [aws_caller_identity.current](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/caller_identity) | data source |
| [aws_region.current](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/region) | data source |

## Inputs

| Name | Description | Type | Default | Required |
|------|-------------|------|---------|:--------:|
| <a name="input_discord_bot_token"></a> [discord\_bot\_token](#input\_discord\_bot\_token) | Discord bot token (for posting follow-up messages) | `string` | n/a | yes |
| <a name="input_discord_guild_id"></a> [discord\_guild\_id](#input\_discord\_guild\_id) | Discord server ID where slash commands are registered | `string` | n/a | yes |
| <a name="input_discord_public_key"></a> [discord\_public\_key](#input\_discord\_public\_key) | Discord application public key (for signature verification) | `string` | n/a | yes |
| <a name="input_logging_bucket"></a> [logging\_bucket](#input\_logging\_bucket) | S3 bucket for access logs | `string` | n/a | yes |
| <a name="input_aws_region"></a> [aws\_region](#input\_aws\_region) | AWS region | `string` | `"us-east-1"` | no |
| <a name="input_environment"></a> [environment](#input\_environment) | Deployment environment | `string` | `"prod"` | no |
| <a name="input_lambda_memory_size"></a> [lambda\_memory\_size](#input\_lambda\_memory\_size) | Lambda memory in MB | `number` | `512` | no |
| <a name="input_lambda_timeout"></a> [lambda\_timeout](#input\_lambda\_timeout) | Lambda timeout in seconds | `number` | `120` | no |
| <a name="input_position_check_schedule"></a> [position\_check\_schedule](#input\_position\_check\_schedule) | Cron expression for position check (default: every 30 min during market hours ET) | `string` | `"cron(0/30 13-20 ? * MON-FRI *)"` | no |
| <a name="input_project"></a> [project](#input\_project) | Project name, used as prefix for all resources | `string` | `"signal-bot"` | no |

## Outputs

| Name | Description |
|------|-------------|
| <a name="output_interactions_endpoint_url"></a> [interactions\_endpoint\_url](#output\_interactions\_endpoint\_url) | Set this as your Discord app's Interactions Endpoint URL |
| <a name="output_lambda_function_arn"></a> [lambda\_function\_arn](#output\_lambda\_function\_arn) | ARN of the deployed Lambda function |
| <a name="output_lambda_function_name"></a> [lambda\_function\_name](#output\_lambda\_function\_name) | Name of the deployed Lambda function |
| <a name="output_s3_bucket"></a> [s3\_bucket](#output\_s3\_bucket) | S3 bucket for Lambda deployment packages |
| <a name="output_secrets_prefix"></a> [secrets\_prefix](#output\_secrets\_prefix) | Secrets Manager prefix for user credentials |
| <a name="output_trade_log_table_arn"></a> [trade\_log\_table\_arn](#output\_trade\_log\_table\_arn) | DynamoDB table ARN for trade logs |
| <a name="output_trade_log_table_name"></a> [trade\_log\_table\_name](#output\_trade\_log\_table\_name) | DynamoDB table name for trade logs |
<!-- END_TF_DOCS -->

## Development

### Dependencies

This project can install most dependencies automatically using a package manager, so please make sure they are installed.

* Windows: [Chocolatey](https://chocolatey.org/)
* MacOS: [Homebrew](https://brew.sh/)

Now run `make install` and most tools will be installed for you.

> [!WARNING]
> [pre-commit](https://pre-commit.com/#install) and [Checkov](https://www.checkov.io/2.Basics/Installing%20Checkov.html) need to be installed manually on Windows.

### Pre Commit

The Pre-Commit framework is used to manage and install pre-commit hooks on your local machine. After cloning this repository you can run `make precommit_install` to initialize the hooks. This only needs to be done once after cloning.

### Running Chores

The `make chores` command will automatically update documentation using Terraform-Docs, and will run automatic formatting.

### Security Checks

This project uses Trivy and Checkov for security scanning. You can run `make test_security` to run both tools, while `make test_trivy` and `make test_checkov` run each component on its own.

### Linting

To run TFLint use the command `make test_tflint`.

It is possible to automatically apply some fixes, but these should be reviewed before running. If you are comfortable with all of the results from `make test_tflint` being fixed automatically then run `make fix_tflint`.

